---
import Head from "../../component/backend/head.astro";
import Foot from "../../component/backend/foot.astro";

const isError = Astro.url.searchParams.get("error") === "1";
const token = Astro.locals.token;

if(token !== null) {
  return Astro.redirect("/admin/dashboard");
}
---

<!doctype html>
<html
  lang="en"
  dir="ltr"
  data-bs-theme="light"
  data-color-theme="Blue_Theme"
  data-layout="vertical"
>
  <Head  title="Login Profil" />
  <body>
    <!-- Preloader -->
    <div class="preloader">
      <img
        src="../assets/images/logos/favicon.png"
        alt="loader"
        class="lds-ripple img-fluid"
      />
    </div>
    <div id="main-wrapper" class="auth-customizer-none">
      <div
        class="position-relative overflow-hidden radial-gradient min-vh-100 w-100 d-flex align-items-center justify-content-center"
      >
        <div class="d-flex align-items-center justify-content-center w-100">
          <div class="row justify-content-center w-100">
            <div class="col-md-8 col-lg-6 col-xxl-3 auth-card">
              <div class="card mb-0">
                <div class="card-body">
                  <a
                    href="../main/index.html"
                    class="text-nowrap logo-img text-center d-block mb-5 w-100"
                  >
                    <img
                      src="assets/khal.png"
                      class="dark-logo"
                      alt="Logo-Dark"
                      width="200"
                    />
                    <img
                      src="assets/images/logos/light-logo.svg"
                      class="light-logo"
                      alt="Logo-light"
                    />
                  </a>
                  <form method="POST" action="/controller/login">
                    <div class="mb-3">
                      <label for="loginUsername" class="form-label"
                        >Username</label
                      >
                      <input
                        type="text"
                        class="form-control"
                        id="loginUsername"
                        name="username"
                        placeholder="Username..."
                      />
                    </div>
                    <div class="mb-4">
                      <label for="loginPassword" class="form-label"
                        >Password</label
                      >
                      <input
                        type="password"
                        class="form-control"
                        id="loginPassword"
                        name="password"
                        placeholder="Password..."
                      />
                    </div>
                    <button
                      type="submit"
                      class="btn btn-primary w-100 py-8 mb-4 rounded-2"
                    >
                      Log In
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="dark-transparent sidebartoggler"></div>
    <Foot />
    {isError && (
  <script is:inline>
    document.addEventListener("DOMContentLoaded", function () {
      if (window.iziToast) {
        window.iziToast.error({
          title: "Login gagal",
          message: "Username atau password salah.",
          position: "topRight",
        });
      }
    });
  </script>
)}

  </body>
</html>
