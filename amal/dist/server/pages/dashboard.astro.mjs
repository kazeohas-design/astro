import { e as createComponent, f as createAstro, r as renderTemplate, n as renderComponent, m as maybeRenderHead, h as addAttribute } from '../chunks/astro/server_BcueGiGm.mjs';
import { $ as $$BaseLayout } from '../chunks/BaseLayout_CsKcIMyr.mjs';
export { renderers } from '../renderers.mjs';

var __freeze = Object.freeze;
var __defProp = Object.defineProperty;
var __template = (cooked, raw) => __freeze(__defProp(cooked, "raw", { value: __freeze(raw || cooked.slice()) }));
var _a;
const $$Astro = createAstro();
const $$Index = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro, $$props, $$slots);
  Astro2.self = $$Index;
  const token = Astro2.locals.token;
  const url = "https://amalapi.khazeo.dev";
  const headers = { Authorization: `${token}` };
  const response = await fetch(`${url}/dashboard`, { headers });
  const data = await response.json();
  const dashboard = data?.dashboard ?? {};
  const dataPerbulan = data?.data ?? [];
  const labelsPerbulan = data?.labels ?? [];
  const dataLayanan = data?.topLayanan.layanan ?? [];
  const dataTotalLayanan = data?.topLayanan.total ?? [];
  return renderTemplate(_a || (_a = __template(["", ' <script>\n  document.addEventListener("DOMContentLoaded", () => {\n    const el = document.querySelector("#chart");\n    if (!el || typeof ApexCharts === "undefined") return;\n    const rawPerbulan = JSON.parse(\n      document.getElementById("chart")?.dataset?.perbulan || "[]",\n    );\n    const rawLabels = JSON.parse(\n      document.getElementById("chart")?.dataset?.labels || "[]",\n    );\n    const defaultMonths = [\n      "Jan",\n      "Feb",\n      "Mar",\n      "Apr",\n      "Mei",\n      "Jun",\n      "Jul",\n      "Agu",\n      "Sep",\n      "Okt",\n      "Nov",\n      "Des",\n    ];\n    let categories = [];\n    let seriesData = [];\n    if (Array.isArray(rawPerbulan)) {\n      if (rawPerbulan.length > 0 && typeof rawPerbulan[0] === "number") {\n        seriesData = rawPerbulan;\n        if (Array.isArray(rawLabels) && rawLabels.length) {\n          categories = rawLabels;\n        } else {\n          categories = defaultMonths.slice(0, rawPerbulan.length);\n        }\n      } else {\n        rawPerbulan.forEach((item) => {\n          if (!item) return;\n          const label =\n            item.bulan || item.month || item.label || item.nama || item.periode;\n          const value =\n            item.jumlah || item.total || item.count || item.nilai || item.value;\n          if (label !== undefined && value !== undefined) {\n            categories.push(String(label));\n            seriesData.push(Number(value));\n          }\n        });\n      }\n    }\n    if (!categories.length) categories = defaultMonths;\n    if (!seriesData.length) {\n      seriesData = [\n        2.3, 3.1, 4.0, 10.1, 4.0, 3.6, 3.2, 2.3, 1.4, 0.8, 0.5, 0.2,\n      ];\n    }\n    const options = {\n      series: [\n        {\n          name: "Pengaduan",\n          data: seriesData,\n        },\n      ],\n      chart: {\n        type: "bar",\n        height: 370,\n        toolbar: { show: false },\n      },\n      plotOptions: {\n        bar: {\n          borderRadius: 6,\n          columnWidth: "55%",\n        },\n      },\n      dataLabels: {\n        enabled: false,\n      },\n      xaxis: {\n        categories,\n        position: "bottom",\n        axisBorder: { show: false },\n        axisTicks: { show: false },\n        labels: {\n          rotate: 0,\n          hideOverlappingLabels: true,\n          trim: false,\n          style: {\n            colors: "#6c757d",\n            fontSize: "12px",\n          },\n        },\n        tooltip: { enabled: true },\n      },\n      yaxis: {\n        axisBorder: { show: false },\n        axisTicks: { show: false },\n        labels: {\n          show: true,\n          formatter: function (val) {\n            return val;\n          },\n        },\n      },\n      grid: {\n        strokeDashArray: 4,\n        borderColor: "rgba(0,0,0,0.08)",\n        xaxis: {\n          lines: { show: false },\n        },\n        padding: {\n          top: 8,\n          bottom: 0,\n          left: 0,\n          right: 0,\n        },\n      },\n      title: {\n        text: "Pengaduan per Bulan",\n        align: "left",\n        style: { color: "#444", fontWeight: 600 },\n      },\n      responsive: [\n        {\n          breakpoint: 992,\n          options: {\n            chart: { height: 300 },\n            plotOptions: { bar: { columnWidth: "60%" } },\n            xaxis: {\n              labels: { style: { fontSize: "11px" } },\n            },\n          },\n        },\n        {\n          breakpoint: 576,\n          options: {\n            chart: { height: 260 },\n            plotOptions: { bar: { columnWidth: "70%" } },\n            xaxis: {\n              labels: {\n                style: { fontSize: "10px" },\n                formatter: function (val, index) {\n                  return index % 2 === 0 ? val : "";\n                },\n              },\n            },\n          },\n        },\n      ],\n    };\n    const chart = new ApexCharts(el, options);\n    chart.render();\n\n    const top5El = document.querySelector("#top5-chart");\n\n    const rawsLabelLayanan = JSON.parse(\n      document.getElementById("top5-chart")?.dataset?.layanan_label || "[]",\n    );\n    const rawsTotalLayanan = JSON.parse(\n      document.getElementById("top5-chart")?.dataset?.layanan_total || "[]",\n    );\n    if (!top5El || typeof ApexCharts === "undefined") return;\n    const normalizeToArray = (value) =>\n      Array.isArray(value) ? value : value ? [value] : [];\n    const rawLabelsLayanan = normalizeToArray(rawsLabelLayanan);\n    const rawTotals = normalizeToArray(rawsTotalLayanan);\n    let top5Labels = [];\n    let top5Values = [];\n\n    if (rawLabelsLayanan.length && rawTotals.length) {\n      top5Labels = rawLabelsLayanan.map((item) =>\n        typeof item === "string" ? item : item?.label || item?.layanan || "",\n      );\n      top5Values = rawTotals.map((item) =>\n        typeof item === "number" ? item : Number(item?.total ?? item),\n      );\n    } else if (Array.isArray(rawsLabelLayanan) && rawsLabelLayanan.length) {\n      top5Labels = rawsLabelLayanan.map((item) => item?.label || item?.layanan);\n      top5Values = rawsLabelLayanan.map((item) =>\n        Number(item?.total ?? item?.jumlah ?? 0),\n      );\n    }\n\n    top5Labels = top5Labels.filter(\n      (label) => String(label || "").trim() !== "",\n    );\n    top5Values = top5Values.filter((val) => Number.isFinite(val));\n\n    const maxValue = Math.max(...top5Values);\n    const barColors = top5Values.map((val) =>\n      val === maxValue ? "#5c8df6" : "#8fb4ff",\n    );\n    const top5Options = {\n      series: [\n        {\n          name: "Jumlah Layanan",\n          data: top5Values,\n        },\n      ],\n      chart: {\n        height: 370,\n        type: "bar",\n        toolbar: { show: false },\n      },\n      plotOptions: {\n        bar: {\n          horizontal: true,\n          borderRadius: 6,\n          distributed: true,\n          barHeight: "70%",\n        },\n      },\n      colors: barColors,\n      dataLabels: {\n        enabled: true,\n        offsetX: 10,\n        style: {\n          fontSize: "12px",\n          colors: ["#304758"],\n        },\n      },\n      xaxis: {\n        categories: top5Labels,\n        labels: { style: { colors: "#6c757d" } },\n      },\n      yaxis: {\n        labels: { style: { colors: "#6c757d" } },\n      },\n      grid: {\n        borderColor: "rgba(0,0,0,0.05)",\n      },\n      tooltip: {\n        y: {\n          formatter: (val) => `${val} layanan`,\n        },\n      },\n      responsive: [\n        {\n          breakpoint: 992,\n          options: {\n            chart: { height: 300 },\n          },\n        },\n        {\n          breakpoint: 576,\n          options: {\n            chart: { height: 260 },\n          },\n        },\n      ],\n    };\n    const top5Chart = new ApexCharts(top5El, top5Options);\n    top5Chart.render();\n  });\n</script>'], ["", ' <script>\n  document.addEventListener("DOMContentLoaded", () => {\n    const el = document.querySelector("#chart");\n    if (!el || typeof ApexCharts === "undefined") return;\n    const rawPerbulan = JSON.parse(\n      document.getElementById("chart")?.dataset?.perbulan || "[]",\n    );\n    const rawLabels = JSON.parse(\n      document.getElementById("chart")?.dataset?.labels || "[]",\n    );\n    const defaultMonths = [\n      "Jan",\n      "Feb",\n      "Mar",\n      "Apr",\n      "Mei",\n      "Jun",\n      "Jul",\n      "Agu",\n      "Sep",\n      "Okt",\n      "Nov",\n      "Des",\n    ];\n    let categories = [];\n    let seriesData = [];\n    if (Array.isArray(rawPerbulan)) {\n      if (rawPerbulan.length > 0 && typeof rawPerbulan[0] === "number") {\n        seriesData = rawPerbulan;\n        if (Array.isArray(rawLabels) && rawLabels.length) {\n          categories = rawLabels;\n        } else {\n          categories = defaultMonths.slice(0, rawPerbulan.length);\n        }\n      } else {\n        rawPerbulan.forEach((item) => {\n          if (!item) return;\n          const label =\n            item.bulan || item.month || item.label || item.nama || item.periode;\n          const value =\n            item.jumlah || item.total || item.count || item.nilai || item.value;\n          if (label !== undefined && value !== undefined) {\n            categories.push(String(label));\n            seriesData.push(Number(value));\n          }\n        });\n      }\n    }\n    if (!categories.length) categories = defaultMonths;\n    if (!seriesData.length) {\n      seriesData = [\n        2.3, 3.1, 4.0, 10.1, 4.0, 3.6, 3.2, 2.3, 1.4, 0.8, 0.5, 0.2,\n      ];\n    }\n    const options = {\n      series: [\n        {\n          name: "Pengaduan",\n          data: seriesData,\n        },\n      ],\n      chart: {\n        type: "bar",\n        height: 370,\n        toolbar: { show: false },\n      },\n      plotOptions: {\n        bar: {\n          borderRadius: 6,\n          columnWidth: "55%",\n        },\n      },\n      dataLabels: {\n        enabled: false,\n      },\n      xaxis: {\n        categories,\n        position: "bottom",\n        axisBorder: { show: false },\n        axisTicks: { show: false },\n        labels: {\n          rotate: 0,\n          hideOverlappingLabels: true,\n          trim: false,\n          style: {\n            colors: "#6c757d",\n            fontSize: "12px",\n          },\n        },\n        tooltip: { enabled: true },\n      },\n      yaxis: {\n        axisBorder: { show: false },\n        axisTicks: { show: false },\n        labels: {\n          show: true,\n          formatter: function (val) {\n            return val;\n          },\n        },\n      },\n      grid: {\n        strokeDashArray: 4,\n        borderColor: "rgba(0,0,0,0.08)",\n        xaxis: {\n          lines: { show: false },\n        },\n        padding: {\n          top: 8,\n          bottom: 0,\n          left: 0,\n          right: 0,\n        },\n      },\n      title: {\n        text: "Pengaduan per Bulan",\n        align: "left",\n        style: { color: "#444", fontWeight: 600 },\n      },\n      responsive: [\n        {\n          breakpoint: 992,\n          options: {\n            chart: { height: 300 },\n            plotOptions: { bar: { columnWidth: "60%" } },\n            xaxis: {\n              labels: { style: { fontSize: "11px" } },\n            },\n          },\n        },\n        {\n          breakpoint: 576,\n          options: {\n            chart: { height: 260 },\n            plotOptions: { bar: { columnWidth: "70%" } },\n            xaxis: {\n              labels: {\n                style: { fontSize: "10px" },\n                formatter: function (val, index) {\n                  return index % 2 === 0 ? val : "";\n                },\n              },\n            },\n          },\n        },\n      ],\n    };\n    const chart = new ApexCharts(el, options);\n    chart.render();\n\n    const top5El = document.querySelector("#top5-chart");\n\n    const rawsLabelLayanan = JSON.parse(\n      document.getElementById("top5-chart")?.dataset?.layanan_label || "[]",\n    );\n    const rawsTotalLayanan = JSON.parse(\n      document.getElementById("top5-chart")?.dataset?.layanan_total || "[]",\n    );\n    if (!top5El || typeof ApexCharts === "undefined") return;\n    const normalizeToArray = (value) =>\n      Array.isArray(value) ? value : value ? [value] : [];\n    const rawLabelsLayanan = normalizeToArray(rawsLabelLayanan);\n    const rawTotals = normalizeToArray(rawsTotalLayanan);\n    let top5Labels = [];\n    let top5Values = [];\n\n    if (rawLabelsLayanan.length && rawTotals.length) {\n      top5Labels = rawLabelsLayanan.map((item) =>\n        typeof item === "string" ? item : item?.label || item?.layanan || "",\n      );\n      top5Values = rawTotals.map((item) =>\n        typeof item === "number" ? item : Number(item?.total ?? item),\n      );\n    } else if (Array.isArray(rawsLabelLayanan) && rawsLabelLayanan.length) {\n      top5Labels = rawsLabelLayanan.map((item) => item?.label || item?.layanan);\n      top5Values = rawsLabelLayanan.map((item) =>\n        Number(item?.total ?? item?.jumlah ?? 0),\n      );\n    }\n\n    top5Labels = top5Labels.filter(\n      (label) => String(label || "").trim() !== "",\n    );\n    top5Values = top5Values.filter((val) => Number.isFinite(val));\n\n    const maxValue = Math.max(...top5Values);\n    const barColors = top5Values.map((val) =>\n      val === maxValue ? "#5c8df6" : "#8fb4ff",\n    );\n    const top5Options = {\n      series: [\n        {\n          name: "Jumlah Layanan",\n          data: top5Values,\n        },\n      ],\n      chart: {\n        height: 370,\n        type: "bar",\n        toolbar: { show: false },\n      },\n      plotOptions: {\n        bar: {\n          horizontal: true,\n          borderRadius: 6,\n          distributed: true,\n          barHeight: "70%",\n        },\n      },\n      colors: barColors,\n      dataLabels: {\n        enabled: true,\n        offsetX: 10,\n        style: {\n          fontSize: "12px",\n          colors: ["#304758"],\n        },\n      },\n      xaxis: {\n        categories: top5Labels,\n        labels: { style: { colors: "#6c757d" } },\n      },\n      yaxis: {\n        labels: { style: { colors: "#6c757d" } },\n      },\n      grid: {\n        borderColor: "rgba(0,0,0,0.05)",\n      },\n      tooltip: {\n        y: {\n          formatter: (val) => \\`\\${val} layanan\\`,\n        },\n      },\n      responsive: [\n        {\n          breakpoint: 992,\n          options: {\n            chart: { height: 300 },\n          },\n        },\n        {\n          breakpoint: 576,\n          options: {\n            chart: { height: 260 },\n          },\n        },\n      ],\n    };\n    const top5Chart = new ApexCharts(top5El, top5Options);\n    top5Chart.render();\n  });\n</script>'])), renderComponent($$result, "BaseLayout", $$BaseLayout, { "title": "Dashboard" }, { "default": async ($$result2) => renderTemplate` ${maybeRenderHead()}<div class="row"> <div class="col-lg-3 col-md-6"> <div class="card border-0 shadow-sm rounded-4"> <div class="card-body py-3 px-4"> <div class="d-flex align-items-center justify-content-between"> <span class="d-inline-flex align-items-center justify-content-center rounded-circle bg-primary-subtle text-primary p-2"> <i class="ti ti-file fs-5"></i> </span> </div> <p class="mb-1 mt-3 text-muted text-uppercase small fw-semibold">
Total Pengaduan
</p> <h3 class="fw-bold mb-0">${dashboard.total}</h3> </div> </div> </div> <div class="col-lg-3 col-md-6"> <div class="card border-0 shadow-sm rounded-4"> <div class="card-body py-3 px-4"> <div class="d-flex align-items-center justify-content-between"> <span class="d-inline-flex align-items-center justify-content-center rounded-circle bg-success-subtle text-success p-2"> <i class="ti ti-loader fs-5"></i> </span> <span class="badge bg-success rounded-pill px-3 py-1">Proses</span> </div> <p class="mb-1 mt-3 text-muted text-uppercase small fw-semibold">
Sedang Diproses
</p> <h3 class="fw-bold mb-0">${dashboard.diproses}</h3> </div> </div> </div> <div class="col-lg-3 col-md-6"> <div class="card border-0 shadow-sm rounded-4"> <div class="card-body py-3 px-4"> <div class="d-flex align-items-center justify-content-between"> <span class="d-inline-flex align-items-center justify-content-center rounded-circle bg-warning-subtle text-warning p-2"> <i class="ti ti-check fs-5"></i> </span> <span class="badge bg-warning text-dark rounded-pill px-3 py-1">
Selesai
</span> </div> <p class="mb-1 mt-3 text-muted text-uppercase small fw-semibold">
Selesai
</p> <h3 class="fw-bold mb-0">${dashboard.selesai}</h3> </div> </div> </div> <div class="col-lg-3 col-md-6"> <div class="card border-0 shadow-sm rounded-4"> <div class="card-body py-3 px-4"> <div class="d-flex align-items-center justify-content-between"> <span class="d-inline-flex align-items-center justify-content-center rounded-circle bg-danger-subtle text-danger p-2"> <i class="ti ti-alert-circle fs-5"></i> </span> <span class="badge bg-danger rounded-pill px-3 py-1">Belum</span> </div> <p class="mb-1 mt-3 text-muted text-uppercase small fw-semibold">
Belum Ditindak
</p> <h3 class="fw-bold mb-0">${dashboard.belum}</h3> </div> </div> </div> </div> <div class="row"> <div class="col-lg-6 d-flex align-items-stretch"> <div class="card w-100"> <div class="card-body"> <div> <div id="chart" class="mx-n4" data-inline-chart="1"${addAttribute(JSON.stringify(dataPerbulan), "data-perbulan")}${addAttribute(JSON.stringify(labelsPerbulan), "data-labels")}></div> </div> </div> </div> </div> <div class="col-lg-6 d-flex align-items-stretch"> <div class="card w-100"> <div class="card-body"> <div> <h5 class="card-title fw-semibold mb-1">Top 5 Layanan</h5> <p class="card-subtitle mb-0">Berdasarkan jumlah layanan</p> <div id="top5-chart" class="mx-n2"${addAttribute(JSON.stringify(dataLayanan), "data-layanan_label")}${addAttribute(JSON.stringify(dataTotalLayanan), "data-layanan_total")}></div> </div> </div> </div> </div> </div> ` }));
}, "/Users/kazeohasan/Documents/projek/astro/amal/src/pages/dashboard/index.astro", void 0);
const $$file = "/Users/kazeohasan/Documents/projek/astro/amal/src/pages/dashboard/index.astro";
const $$url = "/dashboard";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
  __proto__: null,
  default: $$Index,
  file: $$file,
  url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
