import{d as et,c as o,g as f,h as d,F as _,r as g,p as at,i as lt,o as s,b as t,w as C,k as it,m as K,f as j,v as B,j as S,t as c,n as u,e as P,a as ot}from"./runtime-dom.esm-bundler.CUj3j_Ug.js";import{S as p}from"./sweetalert2.esm.all.NNS-RXd7.js";import{u as st,B as nt,T as dt,a as rt}from"./usePagination.CClfIzvj.js";import{_ as ct}from"./_plugin-vue_export-helper.DlAUqK2U.js";const ut=et({__name:"data",setup(M,{expose:a}){a();const h=g([]),e=g(!1),w=g(!1),k=g("Tambah Penduduk"),l=g("add"),b=g(null),v=g(""),r=g({id:null,kategori:""}),z=at(()=>l.value==="detail"),{page:L,pageSize:G,totalPages:I,pageStartIndex:V,pagedItems:F,pages:U,goFirst:O,goPrev:R,goNext:J,goLast:Y,goTo:H}=st(h,{pageSize:10}),T=g(null);lt(y);async function y(m=""){e.value=!0;try{const i=new URL("/api/backend/penduduk",window.location.origin);m&&i.searchParams.set("search",m);const n=await fetch(i.toString(),{credentials:"include"});if(!n.ok)throw new Error(await n.text());h.value=await n.json()}catch(i){console.error("Gagal memuat data penduduk:",i)}finally{e.value=!1}}function Q(){y(v.value.trim())}function x(){T?.value?.show()}function E(){T?.value?.hide()}function W(){l.value="add",k.value="Tambah Penduduk",r.value={id:null,kategori:""},x()}async function X(m){l.value="edit",k.value="Edit Penduduk",r.value={id:null,kategori:""},x();try{const i=await fetch(`/api/backend/penduduk?id=${m}`,{method:"GET",credentials:"include"});if(!i.ok)throw new Error(await i.text());const n=await i.json();r.value={id:n.id,kategori:n.nik||""}}catch(i){console.error("Gagal memuat detail:",i),p.fire({icon:"error",title:"Oops",text:"Gagal memuat detail."})}}async function Z(m){l.value="detail",k.value="Detail Penduduk",r.value={id:null,kategori:""},x();try{const i=await fetch(`/api/backend/penduduk?fn=detail&id=${m}`,{method:"GET",credentials:"include"});if(!i.ok)throw new Error(await i.text());b.value=await i.json()}catch(i){console.error("Gagal memuat detail:",i),p.fire({icon:"error",title:"Oops",text:"Gagal memuat detail."})}}async function q(m){p.fire({icon:"warning",title:"Peringatan",text:"Anda yakin ingin menghapus penduduk ini?",showCancelButton:!0,confirmButtonText:"Ya, hapus",cancelButtonText:"Tidak"}).then(async i=>{if(i.isConfirmed)try{const n=await fetch(`/api/backend/penduduk?id=${m}`,{method:"DELETE",credentials:"include"});if(!n.ok)throw new Error(await n.text());p.fire({icon:"success",title:"Berhasil",text:"Penduduk berhasil dihapus."}),await n.json(),y()}catch{p.fire({icon:"error",title:"Oops",text:"Gagal menghapus Penduduk."})}})}async function $(){if(!(r.value.kategori??"").trim()){await p.fire({icon:"warning",title:"Validasi",text:"Kategori tidak boleh kosong."});return}w.value=!0;try{const i=!!r.value.id,n=i?`/api/backend/penduduk?id=${r.value.id}`:"/api/backend/penduduk",tt=i?"PUT":"POST",N=new URLSearchParams;r.value.kategori&&N.set("kategori",r.value.kategori);const A=await fetch(n,{method:tt,credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:N.toString()});if(!A.ok)throw new Error(await A.text());await p.fire({icon:"success",title:"Berhasil!",text:i?"Data berhasil diubah!":"Data berhasil dikirim!"}),E(),await y()}catch(i){console.error("Gagal mengirim data:",i),p.fire({icon:"error",title:"Gagal",text:"Gagal mengirim data."})}finally{w.value=!1}}const D={items:h,loading:e,isSaving:w,modalTitle:k,mode:l,detail:b,search:v,form:r,isDetail:z,page:L,pageSize:G,totalPages:I,pageStartIndex:V,pagedItems:F,pages:U,goFirst:O,goPrev:R,goNext:J,goLast:Y,goTo:H,modalRef:T,fetchList:y,doSearch:Q,showModal:x,hideModal:E,openAdd:W,openEdit:X,openDetail:Z,hapusEdit:q,save:$,Button:rt,TableCard:dt,BaseModal:nt};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}}),mt={class:"d-flex flex-column flex-md-row justify-content-md-between align-items-center mb-3 text-center text-md-start gap-2"},gt={class:"d-flex align-items-center justify-content-center justify-content-md-start gap-2"},bt={class:"d-flex justify-content-center justify-content-md-end w-100 w-md-auto"},pt=["onKeydown"],ft={class:"table-responsive border rounded-4"},vt={class:"table text-nowrap mb-0 align-middle",id:"page"},kt={class:"mt-3",style:{"overflow-x":"auto","-webkit-overflow-scrolling":"touch","scrollbar-width":"none",width:"100%"}},yt={class:"d-flex justify-content-end","aria-label":"Pagination"},ht={class:"pagination mb-0 flex-nowrap",style:{"white-space":"nowrap","min-width":"max-content"}},wt=["disabled"],xt=["disabled"],_t=["onClick"],Ct={key:1,class:"page-link text-muted","aria-hidden":"true",style:{"pointer-events":"none",cursor:"default"}},Pt=["disabled"],Tt=["disabled"],jt={class:"d-flex flex-column flex-md-row justify-content-md-between align-items-center mb-3 text-center text-md-start gap-2"},Bt={class:"d-flex justify-content-center justify-content-md-end w-100 w-md-auto"},St=["onKeydown"],Et={class:"mt-3",style:{"overflow-x":"auto","-webkit-overflow-scrolling":"touch","scrollbar-width":"none",width:"100%"}},Dt={class:"d-flex justify-content-end","aria-label":"Pagination"},Nt={class:"pagination mb-0 flex-nowrap",style:{"white-space":"nowrap","min-width":"max-content"}},At=["disabled"],Kt=["disabled"],Mt=["onClick"],zt={key:1,class:"page-link text-muted","aria-hidden":"true",style:{"pointer-events":"none",cursor:"default"}},Lt=["disabled"],Gt=["disabled"],It={key:0},Vt={key:0,class:"row g-3"},Ft={class:"card overflow-hidden"},Ut={class:"card-body p-0"},Ot={class:"row align-items-center"},Rt={class:"col-lg-4 mt-n3 order-lg-2 order-1"},Jt={class:"mt-n5"},Yt={class:"text-center"},Ht={class:"mb-0"},Qt={class:"mb-0"},Wt={class:"tab-content",id:"pills-tabContent"},Xt={class:"tab-pane fade show active",id:"pills-profile",role:"tabpanel","aria-labelledby":"pills-profile-tab",tabindex:"0"},Zt={class:"row"},qt={class:"col-lg-12"},$t={class:"card shadow-none border"},te={class:"card-body"},ee={class:"row"},ae={class:"col-md-6"},le={class:"mb-2"},ie=["value"],oe={class:"col-md-6"},se={class:"mb-2"},ne=["value"],de={class:"col-md-6"},re={class:"mb-2"},ce=["value"],ue={class:"col-md-6"},me={class:"mb-2"},ge=["value"],be={key:1,class:"text-muted"},pe={class:"mb-2"},fe=["value"],ve={key:0};function ke(M,a,h,e,w,k){return s(),o(_,null,[f(e.TableCard,{loading:e.loading,isEmpty:e.items.length===0,title:"Data Penduduk"},{actions:d(()=>[f(e.Button,{class:"btn bg-primary-subtle text-primary",onClick:e.openAdd},{default:d(()=>[...a[12]||(a[12]=[t("i",{class:"ti ti-plus"},null,-1),P(" Tambah ",-1)])]),_:1})]),empty:d(()=>[t("div",jt,[a[18]||(a[18]=t("div",{class:"d-flex align-items-center justify-content-center justify-content-md-start gap-2"},[t("label",{for:"zero_config_length",class:"mb-0"},"Tampilkan"),t("select",{name:"zero_config_length",id:"zero_config_length",class:"form-control w-auto"},[t("option",{value:"10"},"10"),t("option",{value:"25"},"25"),t("option",{value:"50"},"50"),t("option",{value:"100"},"100")])],-1)),t("div",Bt,[C(t("input",{type:"text",name:"cari_penduduk",placeholder:"Cari Penduduk ...",class:"form-control w-100 w-md-20","onUpdate:modelValue":a[6]||(a[6]=l=>e.search=l),onKeydown:K(j(e.doSearch,["prevent"]),["enter"])},null,40,St),[[B,e.search,void 0,{trim:!0}]])])]),a[19]||(a[19]=t("div",{class:"table-responsive border rounded-4"},[t("table",{class:"table text-nowrap mb-0 align-middle",id:"page"},[t("thead",{class:"table-primary"},[t("tr",null,[t("th",null,"No"),t("th",null,"Nama Kategori"),t("th",null,"Aksi")])]),t("tbody",null,[t("tr",null,[t("td",{colspan:"3",class:"text-center"},[t("div",{class:"text-center text-muted py-1"}," Belum ada kategori ")])])])])],-1)),t("div",Et,[t("nav",Dt,[t("ul",Nt,[t("li",{class:u(["page-item",{disabled:e.page===1}])},[t("button",{type:"button",class:"page-link",onClick:a[7]||(a[7]=(...l)=>e.goFirst&&e.goFirst(...l)),disabled:e.page===1}," « ",8,At)],2),t("li",{class:u(["page-item",{disabled:e.page===1}])},[t("button",{type:"button",class:"page-link",onClick:a[8]||(a[8]=(...l)=>e.goPrev&&e.goPrev(...l)),disabled:e.page===1}," ‹ ",8,Kt)],2),(s(!0),o(_,null,S(e.pages,(l,b)=>(s(),o("li",{key:"p-"+b,class:u(["page-item",{active:l===e.page}])},[l!==null?(s(),o("button",{key:0,type:"button",class:"page-link",onClick:v=>e.goTo(l)},c(l),9,Mt)):(s(),o("span",zt," … "))],2))),128)),t("li",{class:u(["page-item",{disabled:e.page===e.totalPages}])},[t("button",{type:"button",class:"page-link",onClick:a[9]||(a[9]=(...l)=>e.goNext&&e.goNext(...l)),disabled:e.page===e.totalPages}," › ",8,Lt)],2),t("li",{class:u(["page-item",{disabled:e.page===e.totalPages}])},[t("button",{type:"button",class:"page-link",onClick:a[10]||(a[10]=(...l)=>e.goLast&&e.goLast(...l)),disabled:e.page===e.totalPages}," » ",8,Gt)],2)])])])]),default:d(()=>[t("div",mt,[t("div",gt,[a[14]||(a[14]=t("label",{for:"zero_config_length",class:"mb-0"},"Tampilkan",-1)),C(t("select",{class:"form-control w-auto","onUpdate:modelValue":a[0]||(a[0]=l=>e.pageSize=l)},[...a[13]||(a[13]=[t("option",{value:"10"},"10",-1),t("option",{value:"25"},"25",-1),t("option",{value:"50"},"50",-1),t("option",{value:"100"},"100",-1)])],512),[[it,e.pageSize,void 0,{number:!0}]])]),t("div",bt,[C(t("input",{type:"text",placeholder:"Cari Penduduk ...",class:"form-control w-100 w-md-20","onUpdate:modelValue":a[1]||(a[1]=l=>e.search=l),onKeydown:K(j(e.doSearch,["prevent"]),["enter"])},null,40,pt),[[B,e.search,void 0,{trim:!0}]])])]),t("div",ft,[t("table",vt,[a[17]||(a[17]=t("thead",{class:"table-primary"},[t("tr",null,[t("th",null,"No"),t("th",null,"NIK"),t("th",null,"Nama"),t("th",null,"Alamat"),t("th",null,"Tempat Tanggal Lahir"),t("th",null,"Aksi")])],-1)),t("tbody",null,[(s(!0),o(_,null,S(e.pagedItems,(l,b)=>(s(),o("tr",{key:l.id},[t("td",null,c(e.pageStartIndex+b+1),1),t("td",null,c(l.nik),1),t("td",null,c(l.nama_penduduk),1),t("td",null,c(l.alamat),1),t("td",null,c(l.tempat)+", "+c(l.tanggal_lahir),1),t("td",null,[f(e.Button,{type:"button",class:"btn btn-sm btn-info text-white me-2",onClick:v=>e.openDetail(l.id)},{default:d(()=>[...a[15]||(a[15]=[t("i",{class:"ti ti-eye fs-4"},null,-1)])]),_:1},8,["onClick"]),f(e.Button,{class:"btn btn-sm btn-danger text-white",onClick:v=>e.hapusEdit(l.id)},{default:d(()=>[...a[16]||(a[16]=[t("i",{class:"ti ti-trash fs-4"},null,-1)])]),_:1},8,["onClick"])])]))),128))])])]),t("div",kt,[t("nav",yt,[t("ul",ht,[t("li",{class:u(["page-item",{disabled:e.page===1}])},[t("button",{type:"button",class:"page-link",onClick:a[2]||(a[2]=(...l)=>e.goFirst&&e.goFirst(...l)),disabled:e.page===1},"«",8,wt)],2),t("li",{class:u(["page-item",{disabled:e.page===1}])},[t("button",{type:"button",class:"page-link",onClick:a[3]||(a[3]=(...l)=>e.goPrev&&e.goPrev(...l)),disabled:e.page===1},"‹",8,xt)],2),(s(!0),o(_,null,S(e.pages,(l,b)=>(s(),o("li",{key:"p-"+b,class:u(["page-item",{active:l===e.page}])},[l!==null?(s(),o("button",{key:0,type:"button",class:"page-link",onClick:v=>e.goTo(l)},c(l),9,_t)):(s(),o("span",Ct,"…"))],2))),128)),t("li",{class:u(["page-item",{disabled:e.page===e.totalPages}])},[t("button",{type:"button",class:"page-link",onClick:a[4]||(a[4]=(...l)=>e.goNext&&e.goNext(...l)),disabled:e.page===e.totalPages},"›",8,Pt)],2),t("li",{class:u(["page-item",{disabled:e.page===e.totalPages}])},[t("button",{type:"button",class:"page-link",onClick:a[5]||(a[5]=(...l)=>e.goLast&&e.goLast(...l)),disabled:e.page===e.totalPages},"»",8,Tt)],2)])])])]),_:1},8,["loading","isEmpty"]),f(e.BaseModal,{ukuranModal:"modal-dialog modal-xl",title:e.modalTitle,ref:"modalRef"},{closeButton:d(()=>[t("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:e.hideModal})]),formModal:d(()=>[e.isDetail?(s(),o("div",It,[e.detail?(s(),o("div",Vt,[t("div",Ft,[t("div",Ut,[a[23]||(a[23]=t("img",{src:"/assets/images/backgrounds/profilebg.jpg",alt:"modernize-img",class:"img-fluid"},null,-1)),t("div",Ot,[a[21]||(a[21]=t("div",{class:"col-lg-4 order-lg-1 order-2"},null,-1)),t("div",Rt,[t("div",Jt,[a[20]||(a[20]=t("div",{class:"d-flex align-items-center justify-content-center mb-2"},[t("div",{class:"d-flex align-items-center justify-content-center round-110"},[t("div",{class:"border border-4 border-white d-flex align-items-center justify-content-center rounded-circle overflow-hidden round-100"},[t("img",{src:"/assets/images/profile/user-1.jpg",alt:"modernize-img",class:"w-100 h-100"})])])],-1)),t("div",Yt,[t("h5",Ht,c(e.detail.nama_penduduk),1),t("p",Qt,c(e.detail.shdrt),1)])])]),a[22]||(a[22]=t("div",{class:"col-lg-4 order-last"},null,-1))]),a[24]||(a[24]=t("ul",{class:"nav nav-pills user-profile-tab justify-content-end mt-2 bg-primary-subtle rounded-2 rounded-top-0",id:"pills-tab",role:"tablist"},[t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link active hstack gap-2 rounded-0 py-6",id:"pills-profile-tab","data-bs-toggle":"pill","data-bs-target":"#pills-profile",type:"button",role:"tab","aria-controls":"pills-profile","aria-selected":"true"},[t("i",{class:"ti ti-user-circle fs-5"}),t("span",{class:"d-none d-md-block"},"Biodata")])]),t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link hstack gap-2 rounded-0 py-6",id:"pills-followers-tab","data-bs-toggle":"pill","data-bs-target":"#pills-followers",type:"button",role:"tab","aria-controls":"pills-followers","aria-selected":"false"},[t("i",{class:"ti ti-folder fs-5"}),t("span",{class:"d-none d-md-block"},"Dokumen")])]),t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link hstack gap-2 rounded-0 py-6",id:"pills-keluarga-tab","data-bs-toggle":"pill","data-bs-target":"#pills-keluarga",type:"button",role:"tab","aria-controls":"pills-followers","aria-selected":"false"},[t("i",{class:"ti ti-users fs-5"}),t("span",{class:"d-none d-md-block"},"Data Keluarga")])])],-1))])]),t("div",Wt,[t("div",Xt,[t("div",Zt,[t("div",qt,[t("div",$t,[t("div",te,[t("div",ee,[t("div",ae,[t("div",le,[a[25]||(a[25]=t("label",{for:"exampleInputname",class:"form-label"},"NIK",-1)),t("input",{type:"text",class:"form-control",value:e.detail.nik,disabled:""},null,8,ie)])]),t("div",oe,[t("div",se,[a[26]||(a[26]=t("label",{for:"exampleInputname",class:"form-label"},"Jenis Kelamin",-1)),t("input",{type:"text",class:"form-control",value:e.detail.jenis_kelamin,disabled:""},null,8,ne)])]),t("div",de,[t("div",re,[a[27]||(a[27]=t("label",{for:"exampleInputname",class:"form-label"},"Tempat, Tanggal Lahir",-1)),t("input",{type:"text",class:"form-control",value:e.detail.tempat+", "+e.detail.tanggal_lahir,disabled:""},null,8,ce)])]),t("div",ue,[t("div",me,[a[28]||(a[28]=t("label",{for:"exampleInputname",class:"form-label"},"Alamat",-1)),t("input",{type:"text",class:"form-control",value:e.detail.alamat,disabled:""},null,8,ge)])])])])])])])]),a[29]||(a[29]=t("div",{class:"tab-pane fade",id:"pills-followers",role:"tabpanel","aria-labelledby":"pills-followers-tab",tabindex:"0"},[t("div",{class:"row"},[t("div",{class:"col-md-6 col-xl-12"},[t("div",{class:"card"},[t("div",{class:"card-body p-4 d-flex align-items-center gap-6 flex-wrap"},[t("i",{class:"ti ti-folder text-primary fs-10"}),t("div",null,[t("h5",{class:"fw-semibold mb-0"},"Akte Kelahiran")]),t("button",{class:"btn btn-outline-primary py-1 px-2 ms-auto"},[t("i",{class:"ti ti-eye fa-2x"})])])])])])],-1)),a[30]||(a[30]=t("div",{class:"tab-pane fade",id:"pills-keluarga",role:"tabpanel","aria-labelledby":"pills-keluarga-tab",tabindex:"0"},[t("div",{class:"row"},[t("div",{class:"col-sm-6 col-lg-4"},[t("div",{class:"card hover-img"},[t("div",{class:"card-body p-4 text-center border-bottom"},[t("img",{src:"/assets/images/profile/user-1.jpg",alt:"modernize-img",class:"rounded-circle mb-3",width:"80",height:"80"}),t("h5",{class:"fw-semibold mb-0"},"Betty Adams"),t("span",{class:"text-dark fs-2"},"Anak")]),t("ul",{class:"px-2 py-2 bg-light list-unstyled d-flex align-items-center justify-content-center mb-0"},[t("i",{class:"ti ti-eye fa-2x me-1"}),P(" Detail Data ")])])])])],-1))])])):(s(),o("div",be,"Memuat detail…"))])):(s(),o("form",{key:1,onSubmit:j(e.save,["prevent"])},[t("div",pe,[a[31]||(a[31]=t("label",{class:"form-label"},"Kategori",-1)),C(t("input",{type:"text",class:"form-control",placeholder:"Kategori","onUpdate:modelValue":a[11]||(a[11]=l=>e.form.kategori=l)},null,512),[[B,e.form.kategori,void 0,{trim:!0}]]),t("input",{type:"hidden",value:e.form.id??""},null,8,fe)])],32))]),footerModal:d(()=>[e.isDetail?ot("",!0):(s(),o("div",ve,[f(e.Button,{class:"btn bg-primary-subtle text-primary",onClick:e.save,loading:e.isSaving},{default:d(()=>[...a[32]||(a[32]=[P("Simpan",-1)])]),_:1},8,["loading"])])),f(e.Button,{class:"btn bg-danger-subtle text-danger",onClick:e.hideModal},{default:d(()=>[...a[33]||(a[33]=[P("Tutup",-1)])]),_:1})]),_:1},8,["title"])],64)}const _e=ct(ut,[["render",ke]]);export{_e as default};
