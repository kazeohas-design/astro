import{d as $,c as s,g as w,h as u,F as v,r as b,i as ee,o as i,b as t,w as j,j as k,t as g,k as A,n as m,e as P,l as te,a as N,f as ae}from"./runtime-dom.esm-bundler.CUj3j_Ug.js";import{S as p}from"./sweetalert2.esm.all.NNS-RXd7.js";import{u as le,B as ne,T as oe,a as ie}from"./usePagination.CClfIzvj.js";import{_ as se}from"./_plugin-vue_export-helper.DlAUqK2U.js";const re=$({__name:"data",setup(G,{expose:l}){l();const x=b([]),e=b([]),_=b([]),f=b(!1),a=b(!1),d=b("Tambah Hak Akses"),c=b([]),h=b({id:null,nama_lengkap:"",username:"",level:"",status:""}),{page:D,pageSize:F,totalPages:U,pageStartIndex:H,pagedItems:I,pages:V,goFirst:R,goPrev:O,goNext:z,goLast:J,goTo:Y}=le(x,{pageSize:10}),C=b(null);ee(()=>{y(),S()});async function y(n=""){f.value=!0;try{const o=new URL("/api/backend/hak_akses",window.location.origin);n&&o.searchParams.set("search",n);const r=await fetch(o.toString(),{credentials:"include"});if(!r.ok)throw new Error(await r.text());x.value=await r.json()}catch(o){console.error("Gagal memuat data Hak:",o)}finally{f.value=!1}}async function B(n=""){f.value=!0;try{const o=new URL("/api/backend/menu",window.location.origin);n&&o.searchParams.set("search",n);const r=await fetch(o.toString(),{credentials:"include"});if(!r.ok)throw new Error(await r.text());e.value=await r.json()}catch(o){console.error("Gagal memuat data Hak:",o)}finally{f.value=!1}}async function S(){f.value=!0;try{const n=new URL("/api/backend/level",window.location.origin),o=await fetch(n.toString(),{credentials:"include"});if(!o.ok)throw new Error(await o.text());_.value=await o.json()}catch(n){console.error("Gagal memuat data user:",n)}finally{f.value=!1}}function K(){y(h.value.level)}function T(){C?.value?.show()}function M(){C?.value?.hide()}function Q(){if(d.value="Tambah User",h.value.level==""){p.fire({icon:"warning",title:"Peringatan",text:"Pilih Level Terlebih Dahulu."});return}B(h.value.level),T()}async function W(n){d.value="Edit User"}async function X(n){p.fire({icon:"warning",title:"Peringatan",text:"Anda yakin ingin menghapus user ini?",showCancelButton:!0,confirmButtonText:"Ya, hapus",cancelButtonText:"Tidak"}).then(async o=>{if(o.isConfirmed)try{const r=await fetch(`/api/backend/hak_akses?id=${n}`,{method:"DELETE",credentials:"include"});if(!r.ok)throw new Error(await r.text());p.fire({icon:"success",title:"Berhasil",text:"Hak Akses berhasil dihapus."}),await r.json(),y(h.value.level)}catch{p.fire({icon:"error",title:"Oops",text:"Gagal menghapus Hak Akses."})}})}async function Z(){a.value=!0;try{const n=!!h.value.id,L=await fetch("/api/backend/hak_akses",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_level:h.value.level,id_menu:c.value})});if(!L.ok)throw new Error(await L.text());await p.fire({icon:"success",title:"Berhasil!",text:n?"Data berhasil diubah!":"Data berhasil dikirim!"}),M(),await y(h.value.level)}catch(n){console.error("Gagal mengirim data:",n),p.fire({icon:"error",title:"Gagal",text:"Gagal mengirim data."})}finally{a.value=!1}}function q(n){const o=c.value.findIndex(r=>r.id===n.id);o===-1?c.value.push({id:n.id,group_menu:n.group_menu}):c.value.splice(o,1)}const E={items:x,menu:e,data_level:_,loading:f,isSaving:a,modalTitle:d,selectedMenuIds:c,form:h,page:D,pageSize:F,totalPages:U,pageStartIndex:H,pagedItems:I,pages:V,goFirst:R,goPrev:O,goNext:z,goLast:J,goTo:Y,modalRef:C,fetchList:y,fetchMenu:B,fetchLevel:S,doSearch:K,showModal:T,hideModal:M,openAdd:Q,openEdit:W,hapusEdit:X,save:Z,toggleMenu:q,Button:ie,TableCard:oe,BaseModal:ne};return Object.defineProperty(E,"__isScriptSetup",{enumerable:!1,value:!0}),E}}),de={class:"d-flex flex-column flex-md-row justify-content-md-between align-items-center mb-3 text-center text-md-start gap-2"},ce={class:"d-flex align-items-center justify-content-center justify-content-md-start gap-2"},ue=["value"],ge={class:"table-responsive border rounded-4"},me={class:"table text-nowrap mb-0 align-middle",id:"page"},be={class:"mt-3",style:{"overflow-x":"auto","-webkit-overflow-scrolling":"touch","scrollbar-width":"none",width:"100%"}},fe={class:"d-flex justify-content-end","aria-label":"Pagination"},he={class:"pagination mb-0 flex-nowrap",style:{"white-space":"nowrap","min-width":"max-content"}},ve=["disabled"],ke=["disabled"],pe=["onClick"],ye={key:1,class:"page-link text-muted","aria-hidden":"true",style:{"pointer-events":"none",cursor:"default"}},we=["disabled"],xe=["disabled"],_e={class:"d-flex flex-column flex-md-row justify-content-md-between align-items-center mb-3 text-center text-md-start gap-2"},Ce={class:"d-flex align-items-center justify-content-center justify-content-md-start gap-2"},Pe=["value"],Be={class:"mt-3",style:{"overflow-x":"auto","-webkit-overflow-scrolling":"touch","scrollbar-width":"none",width:"100%"}},Se={class:"d-flex justify-content-end","aria-label":"Pagination"},Te={class:"pagination mb-0 flex-nowrap",style:{"white-space":"nowrap","min-width":"max-content"}},Me=["disabled"],Ee=["disabled"],Le=["onClick"],je={key:1,class:"page-link text-muted","aria-hidden":"true",style:{"pointer-events":"none",cursor:"default"}},Ae=["disabled"],Ne=["disabled"],Ge={class:"table text-nowrap mb-0 align-middle",id:"page"},De=["checked","onChange"],Fe={key:0};function Ue(G,l,x,e,_,f){return i(),s(v,null,[w(e.TableCard,{loading:e.loading,isEmpty:!(e.items&&e.items.length),title:"Data Hak Akses"},{actions:u(()=>[w(e.Button,{class:"btn bg-primary-subtle text-primary",onClick:e.openAdd},{default:u(()=>[...l[10]||(l[10]=[t("i",{class:"ti ti-plus"},null,-1),P(" Tambah ",-1)])]),_:1})]),empty:u(()=>[t("div",_e,[t("div",Ce,[j(t("select",{class:"form-control","onUpdate:modelValue":l[5]||(l[5]=a=>e.form.level=a),onChange:e.doSearch},[l[14]||(l[14]=t("option",{value:""},"Pilih Level",-1)),(i(!0),s(v,null,k(e.data_level,a=>(i(),s("option",{key:a.id,value:a.id},g(a.level),9,Pe))),128))],544),[[A,e.form.level]])])]),l[15]||(l[15]=t("div",{class:"table-responsive border rounded-4"},[t("table",{class:"table text-nowrap mb-0 align-middle",id:"page"},[t("thead",{class:"table-primary"},[t("tr",null,[t("th",null,"No"),t("th",null,"Menu"),t("th",null,"Group Menu"),t("th",null,"Aksi")])]),t("tbody",null,[t("tr",null,[t("td",{colspan:"4",class:"text-center"},[t("div",{class:"text-center text-muted py-1"}," Pilih Level Terlebih Dahulu")])])])])],-1)),t("div",Be,[t("nav",Se,[t("ul",Te,[t("li",{class:m(["page-item",{disabled:e.page===1}])},[t("button",{type:"button",class:"page-link",onClick:l[6]||(l[6]=(...a)=>e.goFirst&&e.goFirst(...a)),disabled:e.page===1}," « ",8,Me)],2),t("li",{class:m(["page-item",{disabled:e.page===1}])},[t("button",{type:"button",class:"page-link",onClick:l[7]||(l[7]=(...a)=>e.goPrev&&e.goPrev(...a)),disabled:e.page===1}," ‹ ",8,Ee)],2),(i(!0),s(v,null,k(e.pages,(a,d)=>(i(),s("li",{key:"p-"+d,class:m(["page-item",{active:a===e.page}])},[a!==null?(i(),s("button",{key:0,type:"button",class:"page-link",onClick:c=>e.goTo(a)},g(a),9,Le)):(i(),s("span",je," … "))],2))),128)),t("li",{class:m(["page-item",{disabled:e.page===e.totalPages}])},[t("button",{type:"button",class:"page-link",onClick:l[8]||(l[8]=(...a)=>e.goNext&&e.goNext(...a)),disabled:e.page===e.totalPages}," › ",8,Ae)],2),t("li",{class:m(["page-item",{disabled:e.page===e.totalPages}])},[t("button",{type:"button",class:"page-link",onClick:l[9]||(l[9]=(...a)=>e.goLast&&e.goLast(...a)),disabled:e.page===e.totalPages}," » ",8,Ne)],2)])])])]),default:u(()=>[t("div",de,[t("div",ce,[j(t("select",{class:"form-control","onUpdate:modelValue":l[0]||(l[0]=a=>e.form.level=a),onChange:e.doSearch},[l[11]||(l[11]=t("option",{value:""},"Pilih Level",-1)),(i(!0),s(v,null,k(e.data_level,a=>(i(),s("option",{key:a.id,value:a.id},g(a.level),9,ue))),128))],544),[[A,e.form.level]])])]),t("div",ge,[t("table",me,[l[13]||(l[13]=t("thead",{class:"table-primary"},[t("tr",null,[t("th",null,"No"),t("th",null,"Menu"),t("th",null,"Group Menu"),t("th",null,"Aksi")])],-1)),t("tbody",null,[(i(!0),s(v,null,k(e.pagedItems,(a,d)=>(i(),s("tr",{key:a.id},[t("td",null,g(e.pageStartIndex+d+1),1),t("td",null,g(a.menu),1),t("td",null,g(a.group_menu),1),t("td",null,[w(e.Button,{class:"btn btn-sm btn-danger text-white",onClick:c=>e.hapusEdit(a.id)},{default:u(()=>[...l[12]||(l[12]=[t("i",{class:"ti ti-trash fs-4"},null,-1)])]),_:1},8,["onClick"])])]))),128))])])]),t("div",be,[t("nav",fe,[t("ul",he,[t("li",{class:m(["page-item",{disabled:e.page===1}])},[t("button",{type:"button",class:"page-link",onClick:l[1]||(l[1]=(...a)=>e.goFirst&&e.goFirst(...a)),disabled:e.page===1},"«",8,ve)],2),t("li",{class:m(["page-item",{disabled:e.page===1}])},[t("button",{type:"button",class:"page-link",onClick:l[2]||(l[2]=(...a)=>e.goPrev&&e.goPrev(...a)),disabled:e.page===1},"‹",8,ke)],2),(i(!0),s(v,null,k(e.pages,(a,d)=>(i(),s("li",{key:"p-"+d,class:m(["page-item",{active:a===e.page}])},[a!==null?(i(),s("button",{key:0,type:"button",class:"page-link",onClick:c=>e.goTo(a)},g(a),9,pe)):(i(),s("span",ye,"…"))],2))),128)),t("li",{class:m(["page-item",{disabled:e.page===e.totalPages}])},[t("button",{type:"button",class:"page-link",onClick:l[3]||(l[3]=(...a)=>e.goNext&&e.goNext(...a)),disabled:e.page===e.totalPages},"›",8,we)],2),t("li",{class:m(["page-item",{disabled:e.page===e.totalPages}])},[t("button",{type:"button",class:"page-link",onClick:l[4]||(l[4]=(...a)=>e.goLast&&e.goLast(...a)),disabled:e.page===e.totalPages},"»",8,xe)],2)])])])]),_:1},8,["loading","isEmpty"]),w(e.BaseModal,{title:e.modalTitle,ref:"modalRef"},{closeButton:u(()=>[t("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:e.hideModal})]),formModal:u(()=>[t("form",{onSubmit:ae(e.save,["prevent"])},[t("table",Ge,[l[17]||(l[17]=t("thead",{class:"table-primary"},[t("tr",null,[t("th",null,"No"),t("th",null,"Menu"),t("th",null,"Group Menu"),t("th",null,"Aksi")])],-1)),t("tbody",null,[(i(!0),s(v,null,k(e.menu,(a,d)=>(i(),s("tr",{key:a.id},[t("td",null,g(e.pageStartIndex+d+1),1),t("td",null,g(a.menu),1),t("td",null,g(a.group_menu),1),t("td",null,[t("input",{class:"form-check-input success",type:"checkbox",checked:e.selectedMenuIds.some(c=>c.id===a.id),onChange:c=>e.toggleMenu(a)},null,40,De)])]))),128)),e.menu.length==0?(i(),s("tr",Fe,[...l[16]||(l[16]=[t("td",{colspan:"4",class:"text-center"},[t("div",{class:"text-center text-muted py-1"}," Menu Sudah Dipilih ")],-1)])])):N("",!0)])])],32)]),footerModal:u(()=>[e.menu.length!==0?(i(),te(e.Button,{key:0,class:"btn bg-primary-subtle text-primary",onClick:e.save,loading:e.isSaving},{default:u(()=>[...l[18]||(l[18]=[P("Simpan",-1)])]),_:1},8,["loading"])):N("",!0),w(e.Button,{class:"btn bg-danger-subtle text-danger",onClick:e.hideModal},{default:u(()=>[...l[19]||(l[19]=[P("Tutup",-1)])]),_:1})]),_:1},8,["title"])],64)}const Oe=se(re,[["render",Ue]]);export{Oe as default};
