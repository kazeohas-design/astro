import{d as Z,c as s,g as b,h as r,F as y,r as m,i as q,o as d,b as t,w as x,k as $,m as N,f as T,v as B,j as P,t as k,n as c,e as S}from"./runtime-dom.esm-bundler.CUj3j_Ug.js";import{S as u}from"./sweetalert2.esm.all.NNS-RXd7.js";import{u as ee,B as te,T as ae,a as le}from"./usePagination.CClfIzvj.js";import{_ as ne}from"./_plugin-vue_export-helper.DlAUqK2U.js";const oe=Z({__name:"data",setup(z,{expose:a}){a();const p=m([]),e=m(!1),w=m(!1),h=m("Tambah Level"),l=m(""),o=m({id:null,level:""}),{page:f,pageSize:A,totalPages:F,pageStartIndex:G,pagedItems:U,pages:V,goFirst:D,goPrev:K,goNext:I,goLast:O,goTo:R}=ee(p,{pageSize:10}),_=m(null);q(v);async function v(g=""){e.value=!0;try{const n=new URL("/api/backend/level",window.location.origin);g&&n.searchParams.set("search",g);const i=await fetch(n.toString(),{credentials:"include"});if(!i.ok)throw new Error(await i.text());p.value=await i.json()}catch(n){console.error("Gagal memuat data level:",n)}finally{e.value=!1}}function Y(){v(l.value.trim())}function C(){_?.value?.show()}function L(){_?.value?.hide()}function H(){h.value="Tambah Level",o.value={id:null,level:""},C()}async function J(g){h.value="Edit Level",o.value={id:null,level:""},C();try{const n=await fetch(`/api/backend/level?id=${g}`,{method:"GET",credentials:"include"});if(!n.ok)throw new Error(await n.text());const i=await n.json();o.value={id:i.id,level:i.level||""}}catch(n){console.error("Gagal memuat detail:",n),u.fire({icon:"error",title:"Oops",text:"Gagal memuat detail."})}}async function Q(g){u.fire({icon:"warning",title:"Peringatan",text:"Anda yakin ingin menghapus level ini?",showCancelButton:!0,confirmButtonText:"Ya, hapus",cancelButtonText:"Tidak"}).then(async n=>{if(n.isConfirmed)try{const i=await fetch(`/api/backend/level?id=${g}`,{method:"DELETE",credentials:"include"});if(!i.ok)throw new Error(await i.text());u.fire({icon:"success",title:"Berhasil",text:"Level berhasil dihapus."}),await i.json(),v()}catch{u.fire({icon:"error",title:"Oops",text:"Gagal menghapus level."})}})}async function W(){if(!(o.value.level??"").trim()){await u.fire({icon:"warning",title:"Validasi",text:"Level tidak boleh kosong."});return}w.value=!0;try{const n=!!o.value.id,i=n?`/api/backend/level?id=${o.value.id}`:"/api/backend/level",X=n?"PUT":"POST",E=new URLSearchParams;o.value.level&&E.set("level",o.value.level);const M=await fetch(i,{method:X,credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:E.toString()});if(!M.ok)throw new Error(await M.text());await u.fire({icon:"success",title:"Berhasil!",text:n?"Data berhasil diubah!":"Data berhasil dikirim!"}),L(),await v()}catch(n){console.error("Gagal mengirim data:",n),u.fire({icon:"error",title:"Gagal",text:"Gagal mengirim data."})}finally{w.value=!1}}const j={items:p,loading:e,isSaving:w,modalTitle:h,search:l,form:o,page:f,pageSize:A,totalPages:F,pageStartIndex:G,pagedItems:U,pages:V,goFirst:D,goPrev:K,goNext:I,goLast:O,goTo:R,modalRef:_,fetchList:v,doSearch:Y,showModal:C,hideModal:L,openAdd:H,openEdit:J,hapusEdit:Q,save:W,Button:le,TableCard:ae,BaseModal:te};return Object.defineProperty(j,"__isScriptSetup",{enumerable:!1,value:!0}),j}}),ie={class:"d-flex flex-column flex-md-row justify-content-md-between align-items-center mb-3 text-center text-md-start gap-2"},se={class:"d-flex align-items-center justify-content-center justify-content-md-start gap-2"},de={class:"d-flex justify-content-center justify-content-md-end w-100 w-md-auto"},re=["onKeydown"],ce={class:"table-responsive border rounded-4"},ge={class:"table text-nowrap mb-0 align-middle",id:"page"},me=["onClick"],ue={class:"mt-3",style:{"overflow-x":"auto","-webkit-overflow-scrolling":"touch","scrollbar-width":"none",width:"100%"}},be={class:"d-flex justify-content-end","aria-label":"Pagination"},fe={class:"pagination mb-0 flex-nowrap",style:{"white-space":"nowrap","min-width":"max-content"}},ve=["disabled"],pe=["disabled"],we=["onClick"],he={key:1,class:"page-link text-muted","aria-hidden":"true",style:{"pointer-events":"none",cursor:"default"}},ye=["disabled"],xe=["disabled"],ke={class:"d-flex flex-column flex-md-row justify-content-md-between align-items-center mb-3 text-center text-md-start gap-2"},_e={class:"d-flex justify-content-center justify-content-md-end w-100 w-md-auto"},Ce=["onKeydown"],Te={class:"mt-3",style:{"overflow-x":"auto","-webkit-overflow-scrolling":"touch","scrollbar-width":"none",width:"100%"}},Be={class:"d-flex justify-content-end","aria-label":"Pagination"},Pe={class:"pagination mb-0 flex-nowrap",style:{"white-space":"nowrap","min-width":"max-content"}},Se=["disabled"],Le=["disabled"],je=["onClick"],Ee={key:1,class:"page-link text-muted","aria-hidden":"true",style:{"pointer-events":"none",cursor:"default"}},Me=["disabled"],Ne=["disabled"],ze={class:"mb-2"},Ae=["value"];function Fe(z,a,p,e,w,h){return d(),s(y,null,[b(e.TableCard,{loading:e.loading,isEmpty:e.items.length===0,title:"Data Level"},{actions:r(()=>[b(e.Button,{class:"btn bg-primary-subtle text-primary",onClick:e.openAdd},{default:r(()=>[...a[12]||(a[12]=[t("i",{class:"ti ti-plus"},null,-1),S(" Tambah ",-1)])]),_:1})]),empty:r(()=>[t("div",ke,[a[18]||(a[18]=t("div",{class:"d-flex align-items-center justify-content-center justify-content-md-start gap-2"},[t("label",{for:"zero_config_length",class:"mb-0"},"Tampilkan"),t("select",{name:"zero_config_length",id:"zero_config_length",class:"form-control w-auto"},[t("option",{value:"10"},"10"),t("option",{value:"25"},"25"),t("option",{value:"50"},"50"),t("option",{value:"100"},"100")])],-1)),t("div",_e,[x(t("input",{type:"text",placeholder:"Cari Level ...",class:"form-control w-100 w-md-20","onUpdate:modelValue":a[6]||(a[6]=l=>e.search=l),onKeydown:N(T(e.doSearch,["prevent"]),["enter"])},null,40,Ce),[[B,e.search,void 0,{trim:!0}]])])]),a[19]||(a[19]=t("div",{class:"table-responsive border rounded-4"},[t("table",{class:"table text-nowrap mb-0 align-middle",id:"page"},[t("thead",{class:"table-primary"},[t("tr",null,[t("th",null,"No"),t("th",null,"Nama Level"),t("th",null,"Aksi")])]),t("tbody",null,[t("tr",null,[t("td",{colspan:"3",class:"text-center"},[t("div",{class:"text-center text-muted py-1"}," Belum ada level ")])])])])],-1)),t("div",Te,[t("nav",Be,[t("ul",Pe,[t("li",{class:c(["page-item",{disabled:e.page===1}])},[t("button",{type:"button",class:"page-link",onClick:a[7]||(a[7]=(...l)=>e.goFirst&&e.goFirst(...l)),disabled:e.page===1}," « ",8,Se)],2),t("li",{class:c(["page-item",{disabled:e.page===1}])},[t("button",{type:"button",class:"page-link",onClick:a[8]||(a[8]=(...l)=>e.goPrev&&e.goPrev(...l)),disabled:e.page===1}," ‹ ",8,Le)],2),(d(!0),s(y,null,P(e.pages,(l,o)=>(d(),s("li",{key:"p-"+o,class:c(["page-item",{active:l===e.page}])},[l!==null?(d(),s("button",{key:0,type:"button",class:"page-link",onClick:f=>e.goTo(l)},k(l),9,je)):(d(),s("span",Ee," … "))],2))),128)),t("li",{class:c(["page-item",{disabled:e.page===e.totalPages}])},[t("button",{type:"button",class:"page-link",onClick:a[9]||(a[9]=(...l)=>e.goNext&&e.goNext(...l)),disabled:e.page===e.totalPages}," › ",8,Me)],2),t("li",{class:c(["page-item",{disabled:e.page===e.totalPages}])},[t("button",{type:"button",class:"page-link",onClick:a[10]||(a[10]=(...l)=>e.goLast&&e.goLast(...l)),disabled:e.page===e.totalPages}," » ",8,Ne)],2)])])])]),default:r(()=>[t("div",ie,[t("div",se,[a[14]||(a[14]=t("label",{for:"zero_config_length",class:"mb-0"},"Tampilkan",-1)),x(t("select",{class:"form-control w-auto","onUpdate:modelValue":a[0]||(a[0]=l=>e.pageSize=l)},[...a[13]||(a[13]=[t("option",{value:"10"},"10",-1),t("option",{value:"25"},"25",-1),t("option",{value:"50"},"50",-1),t("option",{value:"100"},"100",-1)])],512),[[$,e.pageSize,void 0,{number:!0}]])]),t("div",de,[x(t("input",{type:"text",placeholder:"Cari Level ...",class:"form-control w-100 w-md-20","onUpdate:modelValue":a[1]||(a[1]=l=>e.search=l),onKeydown:N(T(e.doSearch,["prevent"]),["enter"])},null,40,re),[[B,e.search,void 0,{trim:!0}]])])]),t("div",ce,[t("table",ge,[a[17]||(a[17]=t("thead",{class:"table-primary"},[t("tr",null,[t("th",null,"No"),t("th",null,"Nama Level"),t("th",null,"Aksi")])],-1)),t("tbody",null,[(d(!0),s(y,null,P(e.pagedItems,(l,o)=>(d(),s("tr",{key:l.id},[t("td",null,k(e.pageStartIndex+o+1),1),t("td",null,k(l.level),1),t("td",null,[t("button",{type:"button",class:"btn btn-sm btn-warning text-white me-2",onClick:f=>e.openEdit(l.id)},[...a[15]||(a[15]=[t("i",{class:"ti ti-edit fs-4"},null,-1)])],8,me),b(e.Button,{class:"btn btn-sm btn-danger text-white",onClick:f=>e.hapusEdit(l.id)},{default:r(()=>[...a[16]||(a[16]=[t("i",{class:"ti ti-trash fs-4"},null,-1)])]),_:1},8,["onClick"])])]))),128))])])]),t("div",ue,[t("nav",be,[t("ul",fe,[t("li",{class:c(["page-item",{disabled:e.page===1}])},[t("button",{type:"button",class:"page-link",onClick:a[2]||(a[2]=(...l)=>e.goFirst&&e.goFirst(...l)),disabled:e.page===1},"«",8,ve)],2),t("li",{class:c(["page-item",{disabled:e.page===1}])},[t("button",{type:"button",class:"page-link",onClick:a[3]||(a[3]=(...l)=>e.goPrev&&e.goPrev(...l)),disabled:e.page===1},"‹",8,pe)],2),(d(!0),s(y,null,P(e.pages,(l,o)=>(d(),s("li",{key:"p-"+o,class:c(["page-item",{active:l===e.page}])},[l!==null?(d(),s("button",{key:0,type:"button",class:"page-link",onClick:f=>e.goTo(l)},k(l),9,we)):(d(),s("span",he,"…"))],2))),128)),t("li",{class:c(["page-item",{disabled:e.page===e.totalPages}])},[t("button",{type:"button",class:"page-link",onClick:a[4]||(a[4]=(...l)=>e.goNext&&e.goNext(...l)),disabled:e.page===e.totalPages},"›",8,ye)],2),t("li",{class:c(["page-item",{disabled:e.page===e.totalPages}])},[t("button",{type:"button",class:"page-link",onClick:a[5]||(a[5]=(...l)=>e.goLast&&e.goLast(...l)),disabled:e.page===e.totalPages},"»",8,xe)],2)])])])]),_:1},8,["loading","isEmpty"]),b(e.BaseModal,{title:e.modalTitle,ref:"modalRef"},{closeButton:r(()=>[t("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:e.hideModal})]),formModal:r(()=>[t("form",{onSubmit:T(e.save,["prevent"])},[t("div",ze,[a[20]||(a[20]=t("label",{class:"form-label"},"Level",-1)),x(t("input",{type:"text",class:"form-control",placeholder:"Level","onUpdate:modelValue":a[11]||(a[11]=l=>e.form.level=l)},null,512),[[B,e.form.level,void 0,{trim:!0}]]),t("input",{type:"hidden",value:e.form.id??""},null,8,Ae)])],32)]),footerModal:r(()=>[b(e.Button,{class:"btn bg-primary-subtle text-primary",onClick:e.save,loading:e.isSaving},{default:r(()=>[...a[21]||(a[21]=[S("Simpan",-1)])]),_:1},8,["loading"]),b(e.Button,{class:"btn bg-danger-subtle text-danger",onClick:e.hideModal},{default:r(()=>[...a[22]||(a[22]=[S("Tutup",-1)])]),_:1})]),_:1},8,["title"])],64)}const Ke=ne(oe,[["render",Fe]]);export{Ke as default};
