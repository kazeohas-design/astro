import{d as Z,c as s,g as b,h as d,F as h,r as m,i as q,o as r,b as e,w as y,k as $,m as N,f as T,v as B,j as P,t as x,n as c,e as S}from"./runtime-dom.esm-bundler.CUj3j_Ug.js";import{S as u}from"./sweetalert2.esm.all.NNS-RXd7.js";import{u as tt,B as et,T as at,a as ot}from"./usePagination.CClfIzvj.js";import{_ as it}from"./_plugin-vue_export-helper.DlAUqK2U.js";const nt=Z({__name:"data",setup(L,{expose:a}){a();const k=m([]),t=m(!1),w=m(!1),v=m("Tambah Kategori"),o=m(""),n=m({id:null,kategori:""}),{page:f,pageSize:z,totalPages:A,pageStartIndex:F,pagedItems:G,pages:U,goFirst:V,goPrev:D,goNext:I,goLast:O,goTo:R}=tt(k,{pageSize:10}),_=m(null);q(p);async function p(g=""){t.value=!0;try{const i=new URL("/api/backend/kategori",window.location.origin);g&&i.searchParams.set("search",g);const l=await fetch(i.toString(),{credentials:"include"});if(!l.ok)throw new Error(await l.text());k.value=await l.json()}catch(i){console.error("Gagal memuat data kategori:",i)}finally{t.value=!1}}function Y(){p(o.value.trim())}function C(){_?.value?.show()}function j(){_?.value?.hide()}function H(){v.value="Tambah Kategori",n.value={id:null,kategori:""},C()}async function J(g){v.value="Edit Kategori",n.value={id:null,kategori:""},C();try{const i=await fetch(`/api/backend/kategori?id=${g}`,{method:"GET",credentials:"include"});if(!i.ok)throw new Error(await i.text());const l=await i.json();n.value={id:l.id,kategori:l.kategori||""}}catch(i){console.error("Gagal memuat detail:",i),u.fire({icon:"error",title:"Oops",text:"Gagal memuat detail."})}}async function Q(g){u.fire({icon:"warning",title:"Peringatan",text:"Anda yakin ingin menghapus kategori ini?",showCancelButton:!0,confirmButtonText:"Ya, hapus",cancelButtonText:"Tidak"}).then(async i=>{if(i.isConfirmed)try{const l=await fetch(`/api/backend/kategori?id=${g}`,{method:"DELETE",credentials:"include"});if(!l.ok)throw new Error(await l.text());u.fire({icon:"success",title:"Berhasil",text:"Kategori berhasil dihapus."}),await l.json(),p()}catch{u.fire({icon:"error",title:"Oops",text:"Gagal menghapus kategori."})}})}async function W(){if(!(n.value.kategori??"").trim()){await u.fire({icon:"warning",title:"Validasi",text:"Kategori tidak boleh kosong."});return}w.value=!0;try{const i=!!n.value.id,l=i?`/api/backend/kategori?id=${n.value.id}`:"/api/backend/kategori",X=i?"PUT":"POST",K=new URLSearchParams;n.value.kategori&&K.set("kategori",n.value.kategori);const M=await fetch(l,{method:X,credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:K.toString()});if(!M.ok)throw new Error(await M.text());await u.fire({icon:"success",title:"Berhasil!",text:i?"Data berhasil diubah!":"Data berhasil dikirim!"}),j(),await p()}catch(i){console.error("Gagal mengirim data:",i),u.fire({icon:"error",title:"Gagal",text:"Gagal mengirim data."})}finally{w.value=!1}}const E={items:k,loading:t,isSaving:w,modalTitle:v,search:o,form:n,page:f,pageSize:z,totalPages:A,pageStartIndex:F,pagedItems:G,pages:U,goFirst:V,goPrev:D,goNext:I,goLast:O,goTo:R,modalRef:_,fetchList:p,doSearch:Y,showModal:C,hideModal:j,openAdd:H,openEdit:J,hapusEdit:Q,save:W,Button:ot,TableCard:at,BaseModal:et};return Object.defineProperty(E,"__isScriptSetup",{enumerable:!1,value:!0}),E}}),lt={class:"d-flex flex-column flex-md-row justify-content-md-between align-items-center mb-3 text-center text-md-start gap-2"},st={class:"d-flex align-items-center justify-content-center justify-content-md-start gap-2"},rt={class:"d-flex justify-content-center justify-content-md-end w-100 w-md-auto"},dt=["onKeydown"],ct={class:"table-responsive border rounded-4"},gt={class:"table text-nowrap mb-0 align-middle",id:"page"},mt=["onClick"],ut={class:"mt-3",style:{"overflow-x":"auto","-webkit-overflow-scrolling":"touch","scrollbar-width":"none",width:"100%"}},bt={class:"d-flex justify-content-end","aria-label":"Pagination"},ft={class:"pagination mb-0 flex-nowrap",style:{"white-space":"nowrap","min-width":"max-content"}},pt=["disabled"],kt=["disabled"],wt=["onClick"],vt={key:1,class:"page-link text-muted","aria-hidden":"true",style:{"pointer-events":"none",cursor:"default"}},ht=["disabled"],yt=["disabled"],xt={class:"d-flex flex-column flex-md-row justify-content-md-between align-items-center mb-3 text-center text-md-start gap-2"},_t={class:"d-flex justify-content-center justify-content-md-end w-100 w-md-auto"},Ct=["onKeydown"],Tt={class:"mt-3",style:{"overflow-x":"auto","-webkit-overflow-scrolling":"touch","scrollbar-width":"none",width:"100%"}},Bt={class:"d-flex justify-content-end","aria-label":"Pagination"},Pt={class:"pagination mb-0 flex-nowrap",style:{"white-space":"nowrap","min-width":"max-content"}},St=["disabled"],jt=["disabled"],Et=["onClick"],Kt={key:1,class:"page-link text-muted","aria-hidden":"true",style:{"pointer-events":"none",cursor:"default"}},Mt=["disabled"],Nt=["disabled"],Lt={class:"mb-2"},zt=["value"];function At(L,a,k,t,w,v){return r(),s(h,null,[b(t.TableCard,{loading:t.loading,isEmpty:t.items.length===0,title:"Data Kategori"},{actions:d(()=>[b(t.Button,{class:"btn bg-primary-subtle text-primary",onClick:t.openAdd},{default:d(()=>[...a[12]||(a[12]=[e("i",{class:"ti ti-plus"},null,-1),S(" Tambah ",-1)])]),_:1})]),empty:d(()=>[e("div",xt,[a[18]||(a[18]=e("div",{class:"d-flex align-items-center justify-content-center justify-content-md-start gap-2"},[e("label",{for:"zero_config_length",class:"mb-0"},"Tampilkan"),e("select",{name:"zero_config_length",id:"zero_config_length",class:"form-control w-auto"},[e("option",{value:"10"},"10"),e("option",{value:"25"},"25"),e("option",{value:"50"},"50"),e("option",{value:"100"},"100")])],-1)),e("div",_t,[y(e("input",{type:"text",name:"cari_kategori",placeholder:"Cari Kategori ...",class:"form-control w-100 w-md-20","onUpdate:modelValue":a[6]||(a[6]=o=>t.search=o),onKeydown:N(T(t.doSearch,["prevent"]),["enter"])},null,40,Ct),[[B,t.search,void 0,{trim:!0}]])])]),a[19]||(a[19]=e("div",{class:"table-responsive border rounded-4"},[e("table",{class:"table text-nowrap mb-0 align-middle",id:"page"},[e("thead",{class:"table-primary"},[e("tr",null,[e("th",null,"No"),e("th",null,"Nama Kategori"),e("th",null,"Aksi")])]),e("tbody",null,[e("tr",null,[e("td",{colspan:"3",class:"text-center"},[e("div",{class:"text-center text-muted py-1"}," Belum ada kategori ")])])])])],-1)),e("div",Tt,[e("nav",Bt,[e("ul",Pt,[e("li",{class:c(["page-item",{disabled:t.page===1}])},[e("button",{type:"button",class:"page-link",onClick:a[7]||(a[7]=(...o)=>t.goFirst&&t.goFirst(...o)),disabled:t.page===1}," « ",8,St)],2),e("li",{class:c(["page-item",{disabled:t.page===1}])},[e("button",{type:"button",class:"page-link",onClick:a[8]||(a[8]=(...o)=>t.goPrev&&t.goPrev(...o)),disabled:t.page===1}," ‹ ",8,jt)],2),(r(!0),s(h,null,P(t.pages,(o,n)=>(r(),s("li",{key:"p-"+n,class:c(["page-item",{active:o===t.page}])},[o!==null?(r(),s("button",{key:0,type:"button",class:"page-link",onClick:f=>t.goTo(o)},x(o),9,Et)):(r(),s("span",Kt," … "))],2))),128)),e("li",{class:c(["page-item",{disabled:t.page===t.totalPages}])},[e("button",{type:"button",class:"page-link",onClick:a[9]||(a[9]=(...o)=>t.goNext&&t.goNext(...o)),disabled:t.page===t.totalPages}," › ",8,Mt)],2),e("li",{class:c(["page-item",{disabled:t.page===t.totalPages}])},[e("button",{type:"button",class:"page-link",onClick:a[10]||(a[10]=(...o)=>t.goLast&&t.goLast(...o)),disabled:t.page===t.totalPages}," » ",8,Nt)],2)])])])]),default:d(()=>[e("div",lt,[e("div",st,[a[14]||(a[14]=e("label",{for:"zero_config_length",class:"mb-0"},"Tampilkan",-1)),y(e("select",{class:"form-control w-auto","onUpdate:modelValue":a[0]||(a[0]=o=>t.pageSize=o)},[...a[13]||(a[13]=[e("option",{value:"10"},"10",-1),e("option",{value:"25"},"25",-1),e("option",{value:"50"},"50",-1),e("option",{value:"100"},"100",-1)])],512),[[$,t.pageSize,void 0,{number:!0}]])]),e("div",rt,[y(e("input",{type:"text",name:"cari_kategori",placeholder:"Cari Kategori ...",class:"form-control w-100 w-md-20","onUpdate:modelValue":a[1]||(a[1]=o=>t.search=o),onKeydown:N(T(t.doSearch,["prevent"]),["enter"])},null,40,dt),[[B,t.search,void 0,{trim:!0}]])])]),e("div",ct,[e("table",gt,[a[17]||(a[17]=e("thead",{class:"table-primary"},[e("tr",null,[e("th",null,"No"),e("th",null,"Nama Kategori"),e("th",null,"Aksi")])],-1)),e("tbody",null,[(r(!0),s(h,null,P(t.pagedItems,(o,n)=>(r(),s("tr",{key:o.id},[e("td",null,x(t.pageStartIndex+n+1),1),e("td",null,x(o.kategori),1),e("td",null,[e("button",{type:"button",class:"btn btn-sm btn-warning text-white me-2",onClick:f=>t.openEdit(o.id)},[...a[15]||(a[15]=[e("i",{class:"ti ti-edit fs-4"},null,-1)])],8,mt),b(t.Button,{class:"btn btn-sm btn-danger text-white",onClick:f=>t.hapusEdit(o.id)},{default:d(()=>[...a[16]||(a[16]=[e("i",{class:"ti ti-trash fs-4"},null,-1)])]),_:1},8,["onClick"])])]))),128))])])]),e("div",ut,[e("nav",bt,[e("ul",ft,[e("li",{class:c(["page-item",{disabled:t.page===1}])},[e("button",{type:"button",class:"page-link",onClick:a[2]||(a[2]=(...o)=>t.goFirst&&t.goFirst(...o)),disabled:t.page===1},"«",8,pt)],2),e("li",{class:c(["page-item",{disabled:t.page===1}])},[e("button",{type:"button",class:"page-link",onClick:a[3]||(a[3]=(...o)=>t.goPrev&&t.goPrev(...o)),disabled:t.page===1},"‹",8,kt)],2),(r(!0),s(h,null,P(t.pages,(o,n)=>(r(),s("li",{key:"p-"+n,class:c(["page-item",{active:o===t.page}])},[o!==null?(r(),s("button",{key:0,type:"button",class:"page-link",onClick:f=>t.goTo(o)},x(o),9,wt)):(r(),s("span",vt,"…"))],2))),128)),e("li",{class:c(["page-item",{disabled:t.page===t.totalPages}])},[e("button",{type:"button",class:"page-link",onClick:a[4]||(a[4]=(...o)=>t.goNext&&t.goNext(...o)),disabled:t.page===t.totalPages},"›",8,ht)],2),e("li",{class:c(["page-item",{disabled:t.page===t.totalPages}])},[e("button",{type:"button",class:"page-link",onClick:a[5]||(a[5]=(...o)=>t.goLast&&t.goLast(...o)),disabled:t.page===t.totalPages},"»",8,yt)],2)])])])]),_:1},8,["loading","isEmpty"]),b(t.BaseModal,{title:t.modalTitle,ref:"modalRef"},{closeButton:d(()=>[e("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:t.hideModal})]),formModal:d(()=>[e("form",{onSubmit:T(t.save,["prevent"]),id:"form-kategori"},[e("div",Lt,[a[20]||(a[20]=e("label",{class:"form-label"},"Kategori",-1)),y(e("input",{type:"text",class:"form-control",placeholder:"Kategori","onUpdate:modelValue":a[11]||(a[11]=o=>t.form.kategori=o)},null,512),[[B,t.form.kategori,void 0,{trim:!0}]]),e("input",{type:"hidden",value:t.form.id??""},null,8,zt)])],32)]),footerModal:d(()=>[b(t.Button,{class:"btn bg-primary-subtle text-primary",onClick:t.save,loading:t.isSaving},{default:d(()=>[...a[21]||(a[21]=[S("Simpan",-1)])]),_:1},8,["loading"]),b(t.Button,{class:"btn bg-danger-subtle text-danger",onClick:t.hideModal},{default:d(()=>[...a[22]||(a[22]=[S("Tutup",-1)])]),_:1})]),_:1},8,["title"])],64)}const Dt=it(nt,[["render",At]]);export{Dt as default};
