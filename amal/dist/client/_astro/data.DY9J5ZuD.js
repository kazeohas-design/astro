import{d as nt,c as s,g as h,h as d,F as b,r as f,i as lt,o as r,b as e,w as u,j as w,t as c,k as K,m as F,f as E,v as k,n as m,e as A}from"./runtime-dom.esm-bundler.CUj3j_Ug.js";import{S as p}from"./sweetalert2.esm.all.NNS-RXd7.js";import{u as ot,B as it,T as st,a as rt}from"./usePagination.CClfIzvj.js";import{_ as dt}from"./_plugin-vue_export-helper.DlAUqK2U.js";const x="/api/backend/unit_kerja",mt=nt({__name:"data",setup(L,{expose:n}){n();const S=f([]),t=f(!1),P=f(!1),B=f("Tambah Unit Kerja"),a=f(""),g=[10,25,50,100],_=[{value:"",label:"Pilih Status"},{value:"Aktif",label:"Aktif"},{value:"Tidak Aktif",label:"Non Aktif"}],V={id:null,nama:"",pimpinan:"",no_hp:"",email:"",status:""},i=f({...V}),{page:O,pageSize:D,totalPages:G,pageStartIndex:H,pagedItems:I,pages:R,goFirst:J,goPrev:Y,goNext:q,goLast:Q,goTo:W}=ot(S,{pageSize:10}),T=f(null);lt(C);async function j(o,l={}){const v=await fetch(o,{credentials:"include",...l});if(!v.ok)throw new Error(await v.text());return await v.json()}function U(o){i.value={id:o?.id??null,nama:o?.nama??"",pimpinan:o?.pimpinan??"",no_hp:o?.no_hp??"",email:o?.email??"",status:o?.status??""}}async function C(o=""){t.value=!0;try{const l=new URL(x,window.location.origin);o&&l.searchParams.set("search",o),S.value=await j(l.toString())}catch(l){console.error("Gagal memuat Data Unit Kerja:",l)}finally{t.value=!1}}function X(){C(a.value.trim())}function N(){T?.value?.show()}function M(){T?.value?.hide()}function Z(){B.value="Tambah Unit Kerja",U(),N()}async function $(o){B.value="Edit Unit Kerja",U(),N();try{const l=await j(`${x}?id=${o}`);U(l)}catch(l){console.error("Gagal memuat detail:",l),p.fire({icon:"error",title:"Oops",text:"Gagal memuat detail."})}}async function tt(o){p.fire({icon:"warning",title:"Peringatan",text:"Anda yakin ingin menghapus unit kerja ini?",showCancelButton:!0,confirmButtonText:"Ya, hapus",cancelButtonText:"Tidak"}).then(async l=>{if(l.isConfirmed)try{await j(`${x}?id=${o}`,{method:"DELETE"}),p.fire({icon:"success",title:"Berhasil",text:"Unit kerja berhasil dihapus."}),C()}catch{p.fire({icon:"error",title:"Oops",text:"Gagal menghapus unit kerja."})}})}async function et(){if(!(i.value.nama??"").trim()){await p.fire({icon:"warning",title:"Validasi",text:"Unit kerja tidak boleh kosong."});return}P.value=!0;try{const l=!!i.value.id,v=l?`${x}?id=${i.value.id}`:x,at="POST",y=new URLSearchParams;i.value.nama&&y.set("nama",i.value.nama),i.value.pimpinan&&y.set("pimpinan",i.value.pimpinan),i.value.no_hp&&y.set("no_hp",i.value.no_hp),i.value.email&&y.set("email",i.value.email),i.value.status&&y.set("status",i.value.status),await j(v,{method:at,headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:y.toString()}),await p.fire({icon:"success",title:"Berhasil!",text:l?"Data berhasil diubah!":"Data berhasil dikirim!"}),M(),await C()}catch(l){console.error("Gagal mengirim data:",l),p.fire({icon:"error",title:"Gagal",text:"Gagal mengirim data."})}finally{P.value=!1}}const z={items:S,loading:t,isSaving:P,modalTitle:B,search:a,apiBase:x,pageSizeOptions:g,statusOptions:_,emptyForm:V,form:i,page:O,pageSize:D,totalPages:G,pageStartIndex:H,pagedItems:I,pages:R,goFirst:J,goPrev:Y,goNext:q,goLast:Q,goTo:W,modalRef:T,requestJson:j,setForm:U,fetchList:C,doSearch:X,showModal:N,hideModal:M,openAdd:Z,openEdit:$,hapusEdit:tt,save:et,Button:rt,TableCard:st,BaseModal:it};return Object.defineProperty(z,"__isScriptSetup",{enumerable:!1,value:!0}),z}}),ut={class:"d-flex flex-column flex-md-row justify-content-md-between align-items-center mb-3 text-center text-md-start gap-2"},ct={class:"d-flex align-items-center justify-content-center justify-content-md-start gap-2"},gt=["value"],bt={class:"d-flex justify-content-center justify-content-md-end w-100 w-md-auto"},ft=["onKeydown"],pt={class:"table-responsive border rounded-4"},vt={class:"table text-nowrap mb-0 align-middle",id:"page"},yt=["onClick"],ht={class:"mt-3",style:{"overflow-x":"auto","-webkit-overflow-scrolling":"touch","scrollbar-width":"none",width:"100%"}},wt={class:"d-flex justify-content-end","aria-label":"Pagination"},kt={class:"pagination mb-0 flex-nowrap",style:{"white-space":"nowrap","min-width":"max-content"}},xt=["disabled"],_t=["disabled"],jt=["onClick"],Ct={key:1,class:"page-link text-muted","aria-hidden":"true",style:{"pointer-events":"none",cursor:"default"}},St=["disabled"],Pt=["disabled"],Bt={class:"d-flex flex-column flex-md-row justify-content-md-between align-items-center mb-3 text-center text-md-start gap-2"},Ut={class:"d-flex align-items-center justify-content-center justify-content-md-start gap-2"},Tt=["value"],Nt={class:"d-flex justify-content-center justify-content-md-end w-100 w-md-auto"},Kt=["onKeydown"],Et={class:"mt-3",style:{"overflow-x":"auto","-webkit-overflow-scrolling":"touch","scrollbar-width":"none",width:"100%"}},At={class:"d-flex justify-content-end","aria-label":"Pagination"},Vt={class:"pagination mb-0 flex-nowrap",style:{"white-space":"nowrap","min-width":"max-content"}},Mt=["disabled"],zt=["disabled"],Ft=["onClick"],Lt={key:1,class:"page-link text-muted","aria-hidden":"true",style:{"pointer-events":"none",cursor:"default"}},Ot=["disabled"],Dt=["disabled"],Gt=["value"],Ht={class:"mb-2"},It={class:"mb-2"},Rt={class:"mb-2"},Jt={class:"mb-2"},Yt={class:"mb-2"},qt=["value"];function Qt(L,n,S,t,P,B){return r(),s(b,null,[h(t.TableCard,{loading:t.loading,isEmpty:t.items.length===0,title:"Data Unit Kerja"},{actions:d(()=>[h(t.Button,{class:"btn bg-primary-subtle text-primary",onClick:t.openAdd},{default:d(()=>[...n[17]||(n[17]=[e("i",{class:"ti ti-plus"},null,-1),A(" Tambah ",-1)])]),_:1})]),empty:d(()=>[e("div",Bt,[e("div",Ut,[n[22]||(n[22]=e("label",{for:"zero_config_length",class:"mb-0"},"Tampilkan",-1)),u(e("select",{name:"zero_config_length",id:"zero_config_length",class:"form-control w-auto","onUpdate:modelValue":n[6]||(n[6]=a=>t.pageSize=a)},[(r(),s(b,null,w(t.pageSizeOptions,a=>e("option",{key:a,value:a},c(a),9,Tt)),64))],512),[[K,t.pageSize,void 0,{number:!0}]])]),e("div",Nt,[u(e("input",{type:"text",name:"cari_unit_kerja",placeholder:"Cari Unit Kerja ...",class:"form-control w-100 w-md-20","onUpdate:modelValue":n[7]||(n[7]=a=>t.search=a),onKeydown:F(E(t.doSearch,["prevent"]),["enter"])},null,40,Kt),[[k,t.search,void 0,{trim:!0}]])])]),n[23]||(n[23]=e("div",{class:"table-responsive border rounded-4"},[e("table",{class:"table text-nowrap mb-0 align-middle",id:"page"},[e("thead",{class:"table-primary"},[e("tr",null,[e("th",null,"No"),e("th",null,"Nama Unit Kerja"),e("th",null,"Pimpinan"),e("th",null,"No Hp"),e("th",null,"Aksi")])]),e("tbody",null,[e("tr",null,[e("td",{colspan:"5",class:"text-center"},[e("div",{class:"text-center text-muted py-1"},"Belum ada unit kerja")])])])])],-1)),e("div",Et,[e("nav",At,[e("ul",Vt,[e("li",{class:m(["page-item",{disabled:t.page===1}])},[e("button",{type:"button",class:"page-link",onClick:n[8]||(n[8]=(...a)=>t.goFirst&&t.goFirst(...a)),disabled:t.page===1}," « ",8,Mt)],2),e("li",{class:m(["page-item",{disabled:t.page===1}])},[e("button",{type:"button",class:"page-link",onClick:n[9]||(n[9]=(...a)=>t.goPrev&&t.goPrev(...a)),disabled:t.page===1}," ‹ ",8,zt)],2),(r(!0),s(b,null,w(t.pages,(a,g)=>(r(),s("li",{key:"p-"+g,class:m(["page-item",{active:a===t.page}])},[a!==null?(r(),s("button",{key:0,type:"button",class:"page-link",onClick:_=>t.goTo(a)},c(a),9,Ft)):(r(),s("span",Lt," … "))],2))),128)),e("li",{class:m(["page-item",{disabled:t.page===t.totalPages}])},[e("button",{type:"button",class:"page-link",onClick:n[10]||(n[10]=(...a)=>t.goNext&&t.goNext(...a)),disabled:t.page===t.totalPages}," › ",8,Ot)],2),e("li",{class:m(["page-item",{disabled:t.page===t.totalPages}])},[e("button",{type:"button",class:"page-link",onClick:n[11]||(n[11]=(...a)=>t.goLast&&t.goLast(...a)),disabled:t.page===t.totalPages}," » ",8,Dt)],2)])])])]),default:d(()=>[e("div",ut,[e("div",ct,[n[18]||(n[18]=e("label",{for:"zero_config_length",class:"mb-0"},"Tampilkan",-1)),u(e("select",{class:"form-control w-auto","onUpdate:modelValue":n[0]||(n[0]=a=>t.pageSize=a)},[(r(),s(b,null,w(t.pageSizeOptions,a=>e("option",{key:a,value:a},c(a),9,gt)),64))],512),[[K,t.pageSize,void 0,{number:!0}]])]),e("div",bt,[u(e("input",{type:"text",name:"cari_unit_kerja",placeholder:"Cari Unit Kerja ...",class:"form-control w-100 w-md-20","onUpdate:modelValue":n[1]||(n[1]=a=>t.search=a),onKeydown:F(E(t.doSearch,["prevent"]),["enter"])},null,40,ft),[[k,t.search,void 0,{trim:!0}]])])]),e("div",pt,[e("table",vt,[n[21]||(n[21]=e("thead",{class:"table-primary"},[e("tr",null,[e("th",null,"No"),e("th",null,"Nama Unit Kerja"),e("th",null,"Pimpinan"),e("th",null,"No Hp"),e("th",null,"Aksi")])],-1)),e("tbody",null,[(r(!0),s(b,null,w(t.pagedItems,(a,g)=>(r(),s("tr",{key:a.id},[e("td",null,c(t.pageStartIndex+g+1),1),e("td",null,c(a.nama),1),e("td",null,c(a.pimpinan),1),e("td",null,c(a.no_hp),1),e("td",null,[e("button",{type:"button",class:"btn btn-sm btn-warning text-white me-2",onClick:_=>t.openEdit(a.id)},[...n[19]||(n[19]=[e("i",{class:"ti ti-edit fs-4"},null,-1)])],8,yt),h(t.Button,{class:"btn btn-sm btn-danger text-white",onClick:_=>t.hapusEdit(a.id)},{default:d(()=>[...n[20]||(n[20]=[e("i",{class:"ti ti-trash fs-4"},null,-1)])]),_:1},8,["onClick"])])]))),128))])])]),e("div",ht,[e("nav",wt,[e("ul",kt,[e("li",{class:m(["page-item",{disabled:t.page===1}])},[e("button",{type:"button",class:"page-link",onClick:n[2]||(n[2]=(...a)=>t.goFirst&&t.goFirst(...a)),disabled:t.page===1},"«",8,xt)],2),e("li",{class:m(["page-item",{disabled:t.page===1}])},[e("button",{type:"button",class:"page-link",onClick:n[3]||(n[3]=(...a)=>t.goPrev&&t.goPrev(...a)),disabled:t.page===1},"‹",8,_t)],2),(r(!0),s(b,null,w(t.pages,(a,g)=>(r(),s("li",{key:"p-"+g,class:m(["page-item",{active:a===t.page}])},[a!==null?(r(),s("button",{key:0,type:"button",class:"page-link",onClick:_=>t.goTo(a)},c(a),9,jt)):(r(),s("span",Ct,"…"))],2))),128)),e("li",{class:m(["page-item",{disabled:t.page===t.totalPages}])},[e("button",{type:"button",class:"page-link",onClick:n[4]||(n[4]=(...a)=>t.goNext&&t.goNext(...a)),disabled:t.page===t.totalPages},"›",8,St)],2),e("li",{class:m(["page-item",{disabled:t.page===t.totalPages}])},[e("button",{type:"button",class:"page-link",onClick:n[5]||(n[5]=(...a)=>t.goLast&&t.goLast(...a)),disabled:t.page===t.totalPages},"»",8,Pt)],2)])])])]),_:1},8,["loading","isEmpty"]),h(t.BaseModal,{title:t.modalTitle,ref:"modalRef"},{closeButton:d(()=>[e("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:t.hideModal})]),formModal:d(()=>[e("form",{onSubmit:E(t.save,["prevent"]),id:"form-unit-kerja"},[e("input",{type:"hidden",value:t.form.id??""},null,8,Gt),e("div",Ht,[n[24]||(n[24]=e("label",{class:"form-label"},"Unit Kerja",-1)),u(e("input",{type:"text",class:"form-control",placeholder:"Unit Kerja","onUpdate:modelValue":n[12]||(n[12]=a=>t.form.nama=a)},null,512),[[k,t.form.nama,void 0,{trim:!0}]])]),e("div",It,[n[25]||(n[25]=e("label",{class:"form-label"},"Email",-1)),u(e("input",{type:"text",class:"form-control",placeholder:"Email","onUpdate:modelValue":n[13]||(n[13]=a=>t.form.email=a)},null,512),[[k,t.form.email,void 0,{trim:!0}]])]),e("div",Rt,[n[26]||(n[26]=e("label",{class:"form-label"},"No. Hp",-1)),u(e("input",{type:"text",class:"form-control",placeholder:"No. Hp","onUpdate:modelValue":n[14]||(n[14]=a=>t.form.no_hp=a)},null,512),[[k,t.form.no_hp,void 0,{trim:!0}]])]),e("div",Jt,[n[27]||(n[27]=e("label",{class:"form-label"},"Penanggung Jawab",-1)),u(e("input",{type:"text",class:"form-control",placeholder:"Penanggungjawab...","onUpdate:modelValue":n[15]||(n[15]=a=>t.form.pimpinan=a)},null,512),[[k,t.form.pimpinan,void 0,{trim:!0}]])]),e("div",Yt,[n[28]||(n[28]=e("label",{class:"form-label"},"Status",-1)),u(e("select",{class:"form-control","onUpdate:modelValue":n[16]||(n[16]=a=>t.form.status=a)},[(r(),s(b,null,w(t.statusOptions,a=>e("option",{key:a.value,value:a.value},c(a.label),9,qt)),64))],512),[[K,t.form.status,void 0,{trim:!0}]])])],32)]),footerModal:d(()=>[h(t.Button,{class:"btn bg-primary-subtle text-primary",onClick:t.save,loading:t.isSaving},{default:d(()=>[...n[29]||(n[29]=[A("Simpan",-1)])]),_:1},8,["loading"]),h(t.Button,{class:"btn bg-danger-subtle text-danger",onClick:t.hideModal},{default:d(()=>[...n[30]||(n[30]=[A("Tutup",-1)])]),_:1})]),_:1},8,["title"])],64)}const te=dt(mt,[["render",Qt]]);export{te as default};
